import open_file
import pattern_count
def cluster_finding(k, t, l, genome):
	"""returns clusters of kmers of length k of incidence t in sliding widows of
	length l in string genome"""

	count2 = []
	clusters = set()
	for i in range(len(genome)-l+1):		
		pattern = genome[i:i+k]
		window = genome[i:i+l]
		#count2.append(pattern)
		#count2.append(window)
		count2.append(pattern_count.pattern_count(window, pattern))
	#return count2
	for i in range(len(genome)-l+1):
		if count2[i] >= t:
			clusters.add(genome[i:i+k])
	return clusters

print cluster_finding(12, 17 , 562, 'GGGATCTGTTGCCCAGTGTATGCTACCGGCCCGGGGCATGGCGAATATTGATATAATTAGAGGCTGAGACGACCGAACGTAACACGGAAGCCTACTTTCAGGGTATACACTGGTAGTATTTATGACTCTAGAGCAGCTATCGCCTATTAGAGCAGCTATTATTTATAGAGCAGCTATCGCGGGCAGAACTTAGAGCAGCTATCAGGATGGATAGAACTTGATCTAGAGCAGCTATAGCGAGTATGTTCCATGCTACTATAGAGCAGCTATACCATAGAGCAGCTATTAGGGATACTTATCGAAATCAGTTCTTTTTAGAGCAGCTATGTATGCGATAGAGCTAGAGCAGCTATAAATCTAGAGCAGCTATTTAGAGCAGCTATGCTATCACATACACGCCTTTTGAGAGCATTTGCAATGATAGGCCAACCCTTTTTTCTAGAGCAGCTATATAGAGCAGCTATTATTAGAGCAGCTATGATCCTATTGCTGTCCGTCCCTGACCCGTAGTTATAGAGCAGCTATCTATTGTTAGAGCAGCTATAACCTGTCGCAGTCAGTGTAGAGCAGCTATAAAAATCTGCGTAGAGCAGCTATCTGAGTTAGAGCAGCTATTAGAGCATAGAGCAGCTATACCGTTTCAGGGTAGAGCAGCTATATGCGTAGAGCAGCTATATTAGAGCAGCTATTGAGGTAAGGTGAGCGCGTCTGATTACACGAATGAATGTTTAATCACGATTCCAGTTCAATGAATGTTTAATGAATGTTTATTAAATGAATGTTTAAGCGTCGTTTTGTACCTCTAGTGCTTGACTTTGGCCCAAAGGGAGTAGGGATAGTAGTTCTATAATGAATAATGAATGTTTATTGTTTGCCTTTTAGGGTGGCCCCAATGAATGTTTAATGAATGTTTATCGGAATGAATGTTTAAATGAATGTTTATTTACAGCACCGTACCGACTTGCATCCGGGACGTTGGTTTTTCTGAATTAGTTAAAGGGTTTTAATGAATGTTTACAGGTGCCCTCTATAATGAATGTTTATTAGGGGGGAATGAATGAATGTTTACCTCAATAATGAATGTTTAAATGAATGTTTAAAATTGCATTAGAAATCAATGAATGAATGAATGTTTAGTTTAAATGAATGTTTAGCTACTTCTGTTAAAGCGAAATGAATGTTTAGTTTATAATGAAAAATGAATGTTTATTTCCTTATAACTAATGAATGAATGAATGTTTAGTTGCAGATGTCCTCACCCACAATGAATGTTTAGCAATGTACGTGGGCCCATCGTGAATAGGAATGAATGTTTATACCCGCCCCGGTCGGGGGGGATCGTCTCTCGGCCGATTAGCGAAGTCCTGAGCGGGCGTACCCTCAAGTGCGCTCTGAGCCAGCGAGAAACTTCAGGCCCACCTTCGACAATTCGACACGTTCTTGTTGTTTTCTGGATTCTCGTCCCGGTTGTGTAAGTAAGTTAGTCCTGCCGAGCTCCTGAGAAAAAATGGCAGCCTAACTCAAGAGAGAGACCTGCACCGACAATTAGCAAGCCGCTAACGGCCACAGTGAAGCTACCCGATCTCTCGGTCGGTCAGAACACAACCAGGTCAGAAGGTCAGAACACATGTGTGGCGACATTTAATCAGCCTCAGGTCAGAACACAGATCTTCCGGTACCAATTGTGTCGAAGATACCTGCTACTATACGCGGTCAGAACACACACTCCCTTACCGTACCACCAGGGCTGGGCCTTACCGTCCTTACCGTCCTTACCGTACCATGCGCCCTTACCGTACCCTGGATGTCCCTTACCGTACCGTCAGAACACACAGTGGAGGTCCTTACCGTACCGCTTTTACGATCCGTGTAAGTGGAGTGGTCAGAACACAGGGTCACCTTCCTTACCGTACCCCGTACCTATCTAGATGCACTCCAGCCTTACCGTACCTCCTTACCGTACCCCCACAACTAGTCGGGTCGGTCAGCCTTACCGTACCACATTGGGTCAGAACACAGGTCAGAACACCTTACCGTACCCATGCGCACCTTACCGTACCCTTACCGTACCACCGTACCCAGAACACAATCATGACGGGGGAATTTGGAGGAGGTATGCGCGGGGTCCTTACCGTACCAGGGTCAGACCTTACCGCCTTACCGTACCGGAGGTATGCGGGAGGTGGCCTTACCGTACCTACAAGTCACACTTTTACGGAGGTATGCGCGCCTTACCGTACCCCTATTCGCCTCCTTACCGTACCTGCGCGTTGCGTCACAGCCTTACCGTACCTGAATGCACAGCACCTTACCGTACCATTGGAGGTATGCGCATCTTTGGCCCTCAAAGCAGGAGCTCAAAGCAGGAGCAGGAAGCAGGTTCTCAAAGCAGGAAGCAGGACAGGAAGGAAGAGGACGGGCTCTCAGTCGCGGCACTCAAAGCCTCAAAGCAGGAAATTTTTAGACCTATCATCCGACTTGAAAGCTCAAAGCAGCTCAAAGCAGGAGCAAGTCTCAAAGCAGGATATGAATGCTCAAAGCACTCAAAGCAGGAACGAACTCCTCAAAGCAGCTCAAAGCAGGAAGGACAGCTCCAACTCAAAGCAGGATTACGGCTCAAAGCAGGACCGACCCTCAAAGCAGGACTCAAAGCAGGAGTCGCGAACACGCGCGCCTCAAAGCAGGAAAAGCCGGTGCTCAAAGCAGGAGCTTAGTGTCTCAAAGCAGGAAAGAATGGACAGAAGAACCACTCAAAGCAGGAAGGAACCACACGCCTCCTCCTCAAAGCAGGATTCATTCGACATTTATTTACCACCGTTGACGTGCTCAAGGGTGCCATTTTATTGGAAACCGGCGGTACCCAACTAACTCGTAACTCCTGGCAAAGTCTTTATGTCCCCCTGCCAGCGAATAACCCCATGGTGACCGAAATGAGGTTAGAAGATGGTATAAGTTCAGGTAACGAAAATCTCCGCCTTTTTAAAGGCACGGGTGAAGAGTTTAGCAATCTCCGCCTTGCCGTTGACTAATCTCAATCTCCGCCTTTGCAAATCTCCGCCTTGGCCACTGTTCTGTACCCCTGGTTGTTACGATTGAACATAAATCTCCGCCTTACTTCCCAAGTGTTTTAATGTTCAAGTGTTTTAAAAGTGTTTTAATAACAAGTGTTTTAACCTTGTACAATCTCCGCCTTCTTGCTCGGCGATAAATCTCAAGTGTTTTAATGTCAAGCAAGTGTTTTAACTTGTCAAGTGTTTTAACCTTCTAATCTCCGCCTTGAACAACAAGTGTTTTAATTAATACTAAATCTCCGCCTTAATCTCCGCCTTAATCAAGTGTTTTAATCTCCCAAGTGTTTTAAACAAGTGTTTTAAAAGTGTTTTAAGTGTTTTAACTGTCAAGTGTTTTAACGCAATCTCCGCCTTCAAAATCTCAAGTGTTTTAAGCCCGGGTTCAAGTGTTTTAAAAGAACAATCTCCGCCTTGCTTGCAAATCTCCGCCTTGCGCCAATAGTTACGCCAAGTGTTTTAACTTGTTTAATCAAGTGTTTTAAAGGCATAGGCACCAATAAGACCAAGTGTTTTAAGAAAACCTGCATGAACAAGTGTTTTAACGCGAGAGCGTGGTCAACCAAGTGTTTTAATTAAAGTGTTTTAAAAGTGTTTTAAAGCCTTCAGACATTGGGTTCCCCGGGCTTTACCGTATTTCCCTCCTTACATAAGAGTTGTAAGTCAATGAGAGTGGCATATCGCAAAACACATAAACGACTATAATAGTAGGCACACGACCAGTGATCAATGCGTCCATTTCAGCGGCGAATCCCTTCATGGTTTTGGAGGTCTTGGCGGACGCCTGGTTTGTGCGCACTTAATCACTGAAGATTCCTTGAGCTTAATGACTAGCGACATTCTTAAGCAGGCCATAGACTTACCCACACATATAAAAGGGTACCAAAGGGATAAGCCAGGCTACCCTCACACATATAAATCCACACATCACACATATAAATATAACACACATATAAAGGCACACACACACATATACACACACATATAAACCGCGAAGGGGTCAATAATTGTTGGAATTGTTGGGCTGTTGGGCTATGCAAATTGTTGGGCTCTGGGCAATTGTTGGAATTGTTGGGCTAAGGGACAAATAGCAGGTAGTAGAATATAGACTAAAATTGTTGGGCTATCGTATAATTGTTGGGCTATCGTGGCACACAAATTGTTGGGCTTATATAAATCGTGCCCCACAAGCGAGTGCCTTCTTCGTCCTATTACTCGTCCTATTACCCTATTACTATTACATTACAACGGTCCTGTGGCAGCACACACATATAAATAAGTGCACACATATAAAAAAGCCGTCACACATATAAACTTTTAGCACAAAAATTGTTGGGCTAATTGTTGGGCTCATATAAACTCACACATATCAATTGTTGGGCTAATCAATTCTCGTCCTATTACTGTCGTCCTATTACAAATAATTGTTGGAATTGTTGGGCTTTCGTCCTATTACGTGCAATTGAATTGTTGGGCTTGGGCTTATTACTCGTCCTAAATTGTTGGGCTATTACTCAATTGTTGGGCTATTGTTGGGCTAATTCTATGTTTTCGTCCTATTACCACTTTCGTCCTATTACCTCGTCCTATTACCGGCCACTCGTCCTATTACTCCTATTACTGGTTCGTCCTATTACCGTCCTATTACCGTACTATCGTCCTATTACACGTTCAGGCCCTCGTCCTATTACCCCAGTATCCTCTCGGTATCGTCCTATTACTTCCCAGTACGCGAGATCGTCCTATTACCCCAGTACTTGGGTAGGTTCCAGGTTAGGTTCCCAGTAACCCAGTATGCTACCGCATTACCCCAACAGGTCCGGATATTTCTCATCCACTAGGTTCCCAGTACACAGGTTCTCATCCACTGGGAACCGTTCTCATCCACTGATATATACACCTTTCTCATCCACTCTCATCCATTCTCATCCACTTCATCCACTCCACTCCCAGATTCTCATCCACTGGGAGCACTTACTCATTCTCATCCACTGGTTCCCAGTATTTCTCATCCACTGAGGTTCCCAGTAGTATTCTCATCCACTGTTCCCAGTATTCTCATCCACTTCATCCACTGTTCCCATTCTCATCCACTTTCCCAGTAGCACCTTCTCATCCACTTTCCCAGTATTTCTCATCCACTCCCAGTACTCGCTGTAACCGTTCTCATCCACTATCCACTTACAGTAAAGCGAAAAGGTTTTCTCATCCACTCACTAGATTCTCATCCTTCTCATCCACTTTCCCAGTAGAGGGTAGTATTTCTCATCCACTATGTTACGGTGCCCTCAAAGAGAGTGGTACTCTGCCGTTCCGTTATTCTCATCCATTCTCATCCACTCTTCTCATCCACTGTGATTTCTCATCCACTACTATTTTTCTCATCCACTATGTGTTCTATTTTAGTTCTCATCCACTGAAGATATCCCTCGGATGAGCTTTAGCCGCCTGCTATCTCCTTACTAAAGACCTCAATATACTGCTCACAGTGCAAGTATTTCTATGCGATGGGGCCTATTCATCCTACGGAGATCCTGATTCGTTTCTATGCGATCTAAAACTCGATAGGCGTCAGGAGTAGTTTCTATGCGATTACAAGTCTTTCTATGCGATTATGCGATCCGTGGGCTTTCTATGCGATTATGCGATTTTCTATGTTTCTATGCGATGCATGCTTCCTTTCTATGCGATTGAATTTCTATGCGATTTTTCTATTTTCTATGCGATGCTTACCTTATTTGGATTTCTATGCGATTCTTTTCTATGCGATCCGAAATTCTGGTCCCACCATGGGCAGTGGTTTCAATTCCTTTTCAATTAATCTGTCCCTTTTCTATGCGATGTGGGGCTCCCTCTTTCTATGCGATTTTTTCTATGCGATTATTCATCGTTTCTATTTCTATGTTTCTATGCGATTTTTCTATGCGATATCCACTGATGTGGATCTCGTTAGCAAATTTCTATGCGATACAACCCACTTTCTTTTCTTTCTATGCGATAGTCCGTTCGCCTTCACAAGATCGACTGCAGACAAATATTTTCTATGCGATAGTTCGTAGCTAGGTGCATCGATGGTTAAGAATACCCGTACAAGGTGTGTTACTTCTGCGACTTAAAGGCTACCATGTGTATCCTGGGTCTTTCGCAGTAATGCGAGGTGATGAAGAGGAACTTCAATGTTAGATGCGTTGTATATTCTATTACAATCCCTGGCGACAACACGACGAACCAGCCTCCCACGCCGTGCATGTTGCGCTTGGTCAGAAGCTGTCCAAGCATGCGTAGCTCACTAAGACAAATGCAAAATAAGATCGCCTGATGACGGAAACAGCCGTAGTAAAAGGATACGCCCTGAACGTCCATCAAGTAAGAAATTCTTAATGTGAACACTTTGTTTTGAGCAAAGCTAGTATGTTGTGCAGCTCTACAGGAGTATACGGCCGGTAAGAGTCGGGTTGGAACGAGAGGATCATCAGTCTTCCGAGCTTCCAACCAATGCCCTTCGGCTTAGATTAATCGGCAAGCACTCGATGTACTATAGCGGCTCCTGCCTTGGGCAATCTGTTCTGTAGTGATCGATGTAATAGCAACCAGATCTCCAGGTTGTTCCTCTCGAGCGAAGTCTATCGGATCATGGTCATTCCGTGAACGAGCCCGTGGGCGGTCAATACCAATTCACTCAGTAAGGCTAAGCTTTAGCGCCCCCACCGGGTGTTTTTTTTTTACAAGTTCGGGACAGTTGGGTCAAGCCTCCGCGCAATCGATGATTTTCTTCTACCTGGACAAACGTCCGTTCCGAGTGTAGATAATAACACAACGATATGAGCTGAAACACATTTAGTTCATTACATTTCTGATACAATGGTACAATACGGCTGTTTACAGCGGTGCACAGGATCTACGCCTTTGTGTAACCCAGGAGCCCGCGGAAAGTTTCTAACAAGCATGCCAGCGGTAAGAAGGATTGGGAGAGGCCACAATCGGGGAAGGATTGACGAGCCTTCCAGGCAACTCTGGATTGCTTCTAACGCTCGGATGCCCTCAGGTCTATAGCTTCTGACCGCTGGACCTATTTTATGATGCTGCTGCCGGGCCTATTGTCTTCTGATTTTTCTCTACAGCTGGGCCTATGAAGTAATTTTCACCCTATGAAGTAATGTCTCTATGAAGTAATATACAGTATCGCCAATATTGCGACCTCGCGATCCGTTGTTCTATGATAAAAAACTGACAAAAAACTGACCGCTATCCGGATATCGTAATATATGCACTGTTCGGTCACGCTATGAAGTAAAAAACTTAAAAAACTGACAAACTTAAAAAACTGACGACTCAGAGGCCTATGAAGTAATATATACCTAAACCCTATGAAGTAATAAGTAATTGCTATTAAAAAACTGACGTAAAAAACTGACATGTGGTACTTACCGTAAAAAACTAAAAAACTGACCTAAAAAACTGACAAAACTGACAAATCTGCTAAAAAACTGACAAAACTGACAGTAATAAAAAACTGACCACTATGAAGTAATAAGTAATCTCATAAAAAACTGACTAATAAAAAACTGATAAAAAACTGACAGATCATTTGGTTTACTATGAAGCTATTAAAAAACTGACTATGAAGTAATTTAAAAAACTGACTAATCACCACATATGTTAAAAAACTGACAAAACTGACTGAGCCCGGTCCCTATGAAGTAATCTATGCTATGAAGTAATATGTAAAAAACTTAAAAAACTGACAAAAAACTAAAAAACTGACACGGCCGTAAAAAACTGACGATTAGATTATTTAATACTAACGTAACTAGGACTGCTATACTCAATACCTTTTGCTACATTCTTGCACACCGCCCCAGGTATCACAGATTCCGCCCGCACTATTCGAGCTAAGCGCGAAACTGCTGTTCGCACAATCTGTCCCCCTCCATACATGGCCGTCTTGCTGAACACTAGCACGGCCATATCGGCACATAGACAGCCTTTAACCAGAAAAGCATCTCAACCGGGGGGCGGAAGTCTCCGCGCGTCACTAGCGGCTTTCGGCTCTCGCCGGCTTTACCCGGGGACAATTCATCTTGGGGCCTATTAAGTGGGCCCCCAACGCACTCATTAAGGCTACAAAAAGCGCACCTCTACCAGAGTCCTTCTACCACCCCTGTGTCCGTGGCCTAACAACAGCGCTCGCCCAACTACACGAGAAGAACAACAACCCGACCGAGGCCTAGATGGCTTATAAATCCCCCACGCAAAACAGGGTCCGTATACCGACTCTAACGAAACAAGGGCTCTCATCTGTATTCAGAGGTATTAAGATGAGGTATTAAGACCTTTGCTCGAGAGGTATTAGAGGTATTAAGACATCGTTCGATGCGCAAGGATCTGGTGAGGTATTAAGAGCAAGGTTGCTTGGGAGGTATTAAGAGGTATTAAGACAGCGGTGCTATTCCCAGGAGCCAGCTTATGGCGGCGCAGGAGGTATTAAGGAGGTATTAAGATCGATGCGCAAGAGGTATTAAGATCTTCGATGCGAGGGAGGTATTAAGATCGATGCGCAAGATTCGATGCGCAAGTCGAGGTATTAAGAGAGGTATTAAGAATTAAGAAAATAACCTCATTGACGCCAGTCTGGGTCGTTGGAGGTATTAAGACTGCTATCGAGGTATTAAGAGGGGGTCGATGCGCAAGTCGATGCGCAAGTGGCAGTACTGCTGAGGGAGGTATGAGGTATTAAGATATTAAGAAGCGCAAGTGGGGAGGTATTAAGAAGATCGATGCGCAAGTAGATCACAACTGAGGTATTAAGATTAAGAGGTATTAAGACGTAACAATCGATGCGCAAGACGCCCATCCGAGAGGTATTAAGAGCAAGTCATTCCGCACGCTGTCAGGATGGTCGATCGATGCGCAAGATCGATGCGCAAGCGCAAGACTGTAGATCCATAACCCGCAAATAGCAGGAAGCGGAGCCAGCGAAGTGCATGGGGGGTCTTCAGCGCATGAATCACTCACGTCTAGAGCTCTGGTGCTAAGGCCCCACACGTAGGTTGCTATACCCTCCACGGCCGGTCCCCTGTACCAACATCCGGGGATGGCGTAGACCAAGGTGATTACCATACTGTGTATTATCGTACCGTCTCCCTGCTACGTGAATCGATAAGATATATGTCCACCCGGGAGAATCTTAGGCTAAATGTAAAGGTATCTCATGTAGTGTTTTGGCGATCCGCCGGCGAGCCAGACAAGGGCACTTTCTTGGGAATTGGCTCGA')
	
	
